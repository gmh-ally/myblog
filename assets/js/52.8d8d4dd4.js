(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{473:function(v,_,e){"use strict";e.r(_);var p=e(2),t=Object(p.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("p",[v._v("常⻅浏览器 JS 对象常⻅ API 及⽤法\n详解浏览器事件捕获，冒泡\najax 及 fetch API 详解\n知识要点")]),v._v(" "),_("p",[v._v("一、浏览器对象模型(BOM),主要对象有:")]),v._v(" "),_("ol",[_("li",[_("p",[v._v("window 对象——BOM 的核⼼，是 js 访问浏览器的接⼝，也是 ES 规定的 Global 对象")])]),v._v(" "),_("li",[_("p",[v._v("location 对象：提供当前窗⼝中的加载的⽂档有关的信息和⼀些导航功能。既是 window 对象属")])])]),v._v(" "),_("p",[v._v("性，也是 document 的对象属性")]),v._v(" "),_("ol",{attrs:{start:"3"}},[_("li",[_("p",[v._v("navigation 对象：获取浏览器的系统信息")])]),v._v(" "),_("li",[_("p",[v._v("screen 对象：⽤来表⽰浏览器窗⼝外部的显⽰器的信息等")])]),v._v(" "),_("li",[_("p",[v._v("history 对象：保存⽤⼾上⽹的历史信息")])])]),v._v(" "),_("p",[v._v("Window 对象")]),v._v(" "),_("p",[v._v("windows 对象是整个浏览器对象模型的核⼼，其扮演着既是接⼝⼜是全局对象的⻆⾊")]),v._v(" "),_("p",[v._v("alert()")]),v._v(" "),_("p",[v._v("confirm()")]),v._v(" "),_("p",[v._v("prompt()")]),v._v(" "),_("p",[v._v("open()")]),v._v(" "),_("p",[v._v("onerror()")]),v._v(" "),_("p",[v._v("setTimeout()")]),v._v(" "),_("p",[v._v("setInterval()")]),v._v(" "),_("p",[v._v("窗⼝位置")]),v._v(" "),_("p",[v._v("screenLeft")]),v._v(" "),_("p",[v._v("screenTop")]),v._v(" "),_("p",[v._v("screenX")]),v._v(" "),_("p",[v._v("screenY")]),v._v(" "),_("p",[v._v("moveBy(x,y)")]),v._v(" "),_("p",[v._v("moveTo(x,y)")]),v._v(" "),_("p",[v._v("窗⼝⼤⼩")]),v._v(" "),_("p",[v._v("innerWidth")]),v._v(" "),_("p",[v._v("innerHeight")]),v._v(" "),_("p",[v._v("outerWidth")]),v._v(" "),_("p",[v._v("outerHeightresizeTo(width, height)")]),v._v(" "),_("p",[v._v("resizeBy(width, height)")]),v._v(" "),_("p",[v._v("定时器")]),v._v(" "),_("p",[v._v("setTimeout")]),v._v(" "),_("p",[v._v("setInterval")]),v._v(" "),_("p",[v._v("Location 对象")]),v._v(" "),_("p",[v._v("提供当前窗⼝中的加载的⽂档有关的信息和⼀些导航功能。既是 window 对象属性，也是 document")]),v._v(" "),_("p",[v._v("的对象属性")]),v._v(" "),_("p",[v._v("location 对象的主要属性：")]),v._v(" "),_("p",[v._v("hash")]),v._v(" "),_("p",[v._v("host")]),v._v(" "),_("p",[v._v("hostname")]),v._v(" "),_("p",[v._v("href")]),v._v(" "),_("p",[v._v("pathname")]),v._v(" "),_("p",[v._v("port")]),v._v(" "),_("p",[v._v("protocol")]),v._v(" "),_("p",[v._v("search")]),v._v(" "),_("p",[v._v("location 的应⽤场景： 讲课时补充")]),v._v(" "),_("p",[v._v("Navigation 对象")]),v._v(" "),_("p",[v._v("navigation 接⼝表⽰⽤⼾代理的状态和标识，允许脚本查询它和注册⾃⼰进⾏⼀些活动")]),v._v(" "),_("p",[v._v("History 对象")]),v._v(" "),_("p",[v._v("history 对象保存着⽤⼾上⽹的历史记录，从窗⼝被打开的那⼀刻算起，history 对象是⽤窗⼝的浏览")]),v._v(" "),_("p",[v._v("历史⽤⽂档和⽂档状态列表的形式表⽰。")]),v._v(" "),_("p",[v._v("go()")]),v._v(" "),_("p",[v._v("back()")]),v._v(" "),_("p",[v._v("forword()")]),v._v(" "),_("p",[v._v("length")]),v._v(" "),_("p",[v._v("⼆、详解浏览器事件捕获，冒泡")]),v._v(" "),_("p",[v._v("浏览器事件模型中的过程主要分为三个阶段：捕获阶段、⽬标阶段、冒泡阶段。")]),v._v(" "),_("p",[v._v("这⾥上课时看图第三个参数")]),v._v(" "),_("p",[v._v("这⾥要注意addEventListener的第三个参数, 如果为true，就是代表在捕获阶段执⾏。如果为false，")]),v._v(" "),_("p",[v._v("就是在冒泡阶段进⾏")]),v._v(" "),_("p",[v._v("上课时看⼀下代码")]),v._v(" "),_("p",[v._v("阻⽌事件传播")]),v._v(" "),_("p",[v._v("e.stopPropagation()")]),v._v(" "),_("p",[v._v("⼤家经常听到的可能是阻⽌冒泡，实际上这个⽅法不只能阻⽌冒泡，还能阻⽌捕获阶段的传播。")]),v._v(" "),_("p",[v._v("stopImmediatePropagation()")]),v._v(" "),_("p",[v._v("如果有多个相同类型事件的事件监听函数绑定到同⼀个元素，当该类型的事件触发时，它们会按")]),v._v(" "),_("p",[v._v("照被添加的顺序执⾏。如果其中某个监听函数执⾏了 event.stopImmediatePropagation() ⽅法，")]),v._v(" "),_("p",[v._v("则当前元素剩下的监听函数将不会被执⾏。")]),v._v(" "),_("p",[v._v("上课时看⼀下代码")]),v._v(" "),_("p",[v._v("阻⽌默认⾏为")]),v._v(" "),_("p",[v._v("e.preventDefault()")]),v._v(" "),_("p",[v._v("e.preventDefault()可以阻⽌事件的默认⾏为发⽣，默认⾏为是指：点击a标签就转跳到其他⻚⾯、拖")]),v._v(" "),_("p",[v._v("拽⼀个图⽚到浏览器会⾃动打开、点击表单的提交按钮会提交表单等等，因为有的时候我们并不希望发⽣这些事情，所以需要阻⽌默认⾏为")]),v._v(" "),_("p",[v._v("兼容性")]),v._v(" "),_("p",[v._v("attachEvent——兼容：IE7、IE8； 不⽀持第三个参数来控制在哪个阶段发⽣，默认是绑定在冒泡阶")]),v._v(" "),_("p",[v._v("段")]),v._v(" "),_("p",[v._v("addEventListener——兼容：firefox、chrome、IE、safari、opera；")]),v._v(" "),_("p",[v._v("三、ajax 及 fetch API 详解")]),v._v(" "),_("ol",[_("li",[_("p",[v._v("XMLHTTPRequest")])]),v._v(" "),_("li",[_("p",[v._v("fetch")])])]),v._v(" "),_("p",[v._v("默认不带cookie")]),v._v(" "),_("p",[v._v("错误不会reject")]),v._v(" "),_("p",[v._v("不⽀持超时设置")]),v._v(" "),_("p",[v._v("需要借⽤AbortController中⽌fetch")]),v._v(" "),_("p",[v._v("常⻅的浏览器请求/响应头/错误码解析")]),v._v(" "),_("p",[v._v("request header")]),v._v(" "),_("p",[v._v(":method:")]),v._v(" "),_("p",[v._v(":path:")]),v._v(" "),_("p",[v._v(":scheme:")]),v._v(" "),_("p",[v._v("accept:")]),v._v(" "),_("p",[v._v("accept-encoding:")]),v._v(" "),_("p",[v._v("cache-control:")]),v._v(" "),_("p",[v._v("cookie:")]),v._v(" "),_("p",[v._v("origin:")]),v._v(" "),_("p",[v._v("referer:")]),v._v(" "),_("p",[v._v("user-agent:")]),v._v(" "),_("p",[v._v("response header")]),v._v(" "),_("p",[v._v("access-control-allow-credentials:")]),v._v(" "),_("p",[v._v("access-control-allow-origin:")]),v._v(" "),_("p",[v._v("content-encoding:")]),v._v(" "),_("p",[v._v("content-type:")]),v._v(" "),_("p",[v._v("date:")]),v._v(" "),_("p",[v._v("set-cookie:")]),v._v(" "),_("p",[v._v("set-cookie:")]),v._v(" "),_("p",[v._v("status:status")]),v._v(" "),_("p",[v._v("200 get 成功")]),v._v(" "),_("p",[v._v("201 post 成功")]),v._v(" "),_("p",[v._v("301 永久重定向")]),v._v(" "),_("p",[v._v("302 临时重定向")]),v._v(" "),_("p",[v._v("304 协商缓存 服务器⽂件未修改")]),v._v(" "),_("p",[v._v("400 客⼾端请求有语法错误，不能被服务器识别")]),v._v(" "),_("p",[v._v("403 服务器受到请求，但是拒绝提供服务，可能是跨域")]),v._v(" "),_("p",[v._v("404 请求的资源不存在")]),v._v(" "),_("p",[v._v("405 请求的method不允许")]),v._v(" "),_("p",[v._v("500 服务器发⽣不可预期的错误")]),v._v(" "),_("p",[v._v("重要实现\n1.封装⼀个多浏览器兼容的绑定事件函数")]),v._v(" "),_("p",[v._v("class BomEvent {")]),v._v(" "),_("p",[v._v("constructor(element) {")]),v._v(" "),_("p",[v._v("this.element = element;")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("addEvent(type, handler) {")]),v._v(" "),_("p",[v._v("if (this.element.addEventListener) {")]),v._v(" "),_("p",[v._v("//事件类型、需要执行的函数、是否捕捉")]),v._v(" "),_("p",[v._v("this.element.addEventListener(type, handler, false);")]),v._v(" "),_("p",[v._v("} else if (this.element.attachEvent) {")]),v._v(" "),_("p",[v._v("this.element.attachEvent('on' + type, function () {")]),v._v(" "),_("p",[v._v("handler.call(element);")]),v._v(" "),_("p",[v._v("});")]),v._v(" "),_("p",[v._v("} else {")]),v._v(" "),_("p",[v._v("this.element['on' + type] = handler;")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("removeEvent(type, handler) {")]),v._v(" "),_("p",[v._v("if (this.element.removeEnentListener) {")]),v._v(" "),_("p",[v._v("this.element.removeEnentListener(type, handler, false);")]),v._v(" "),_("p",[v._v("} else if (element.datachEvent) {")]),v._v(" "),_("p",[v._v("this.element.detachEvent('on' + type, handler);")]),v._v(" "),_("p",[v._v("} else {")]),v._v(" "),_("p",[v._v("this.element['on' + type] = null;")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("// 阻止事件 (主要是事件冒泡，因为IE不支持事件捕获)")]),v._v(" "),_("p",[v._v("function stopPropagation(ev) {")]),v._v(" "),_("p",[v._v("if (ev.stopPropagation) {")]),v._v(" "),_("p",[v._v("ev.stopPropagation(); // 标准w3c")]),v._v(" "),_("p",[v._v("} else {")]),v._v(" "),_("p",[v._v("ev.cancelBubble = true; // IE")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("// 取消事件的默认行为")]),v._v(" "),_("p",[v._v("function preventDefault(event) {")]),v._v(" "),_("p",[v._v("if (event.preventDefault) {")]),v._v(" "),_("p",[v._v("event.preventDefault(); // 标准w3c")]),v._v(" "),_("p",[v._v("} else {")]),v._v(" "),_("p",[v._v("event.returnValue = false; // IE")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("2.封装⼀个多浏览器兼容的请求函数")]),v._v(" "),_("p",[v._v("interface IOptions {")]),v._v(" "),_("p",[v._v("url: string;")]),v._v(" "),_("p",[v._v("type?: string;")]),v._v(" "),_("p",[v._v("data: any;")]),v._v(" "),_("p",[v._v("timeout?: number;")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("function formatUrl(json) {")]),v._v(" "),_("p",[v._v("let dataArr = [];")]),v._v(" "),_("p",[v._v("json.t = Math.random();")]),v._v(" "),_("p",[v._v("for (let key in json) {")]),v._v(" "),_("p",[v._v("dataArr.push("),_("code",[v._v("${key}=${encodeURIComponent(json[key])}")]),v._v(")")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("return dataArr.join('&');")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("export function ajax(options: IOptions) {")]),v._v(" "),_("p",[v._v("return new Promise((resolve, reject) => {")]),v._v(" "),_("p",[v._v("if (!options.url) return;")]),v._v(" "),_("p",[v._v("options.type = options.type || 'GET';")]),v._v(" "),_("p",[v._v("options.data = options.data || {};")]),v._v(" "),_("p",[v._v("options.timeout = options.timeout || 10000;")]),v._v(" "),_("p",[v._v("let dataToUrlstr = formatUrl(options.data);")]),v._v(" "),_("p",[v._v("let timer;")]),v._v(" "),_("p",[v._v("// 1.创建")]),v._v(" "),_("p",[v._v("let xhr;")]),v._v(" "),_("p",[v._v("if ((window as any).XMLHttpRequest) {")]),v._v(" "),_("p",[v._v("xhr = new XMLHttpRequest();")]),v._v(" "),_("p",[v._v("} else {")]),v._v(" "),_("p",[v._v("xhr = new ActiveXObject('Microsoft.XMLHTTP');")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("if (options.type.toUpperCase() === 'GET') {")]),v._v(" "),_("p",[v._v("// 2.连接")]),v._v(" "),_("p",[v._v("xhr.open('get', "),_("code",[v._v("${options.url}?${dataToUrlstr}")]),v._v(", true);")]),v._v(" "),_("p",[v._v("// 3.发送")]),v._v(" "),_("p",[v._v("xhr.send();")]),v._v(" "),_("p",[v._v("} else if (options.type.toUpperCase() === 'POST') {")]),v._v(" "),_("p",[v._v("// 2.连接")]),v._v(" "),_("p",[v._v("xhr.open('post', options.url, true);")]),v._v(" "),_("p",[v._v("xhr.setRequestHeader('ContentType', 'application/x-www-form-urlencoded');")]),v._v(" "),_("p",[v._v("// 3.发送")]),v._v(" "),_("p",[v._v("xhr.send(options.data);")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("// 4.接收")]),v._v(" "),_("p",[v._v("xhr.onreadystatechange = () => {")]),v._v(" "),_("p",[v._v("if (xhr.readyState === 4) {")]),v._v(" "),_("p",[v._v("clearTimeout(timer);")]),v._v(" "),_("p",[v._v("if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {")]),v._v(" "),_("p",[v._v("resolve(xhr.responseText);")]),v._v(" "),_("p",[v._v("} else {")]),v._v(" "),_("p",[v._v("reject(xhr.status);")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("if (options.timeout) {")]),v._v(" "),_("p",[v._v("timer = setTimeout(() => {")]),v._v(" "),_("p",[v._v("xhr.abort();")]),v._v(" "),_("p",[v._v("reject('超时');")]),v._v(" "),_("p",[v._v("}, options.timeout)")]),v._v(" "),_("p",[v._v("}")]),v._v(" "),_("p",[v._v("// xhr.timeout = options.timeout;")]),v._v(" "),_("p",[v._v("// xhr.ontimeout = () => {")]),v._v(" "),_("p",[v._v("// reject('超时');")]),v._v(" "),_("p",[v._v("// }")]),v._v(" "),_("p",[v._v("});")]),v._v(" "),_("p",[v._v("}")])])}),[],!1,null,null,null);_.default=t.exports}}]);